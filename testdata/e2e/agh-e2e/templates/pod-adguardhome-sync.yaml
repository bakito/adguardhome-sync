apiVersion: v1
kind: Pod
metadata:
  name: adguardhome-sync
  namespace: {{ $.Release.Namespace }}
  labels:
    bakito.net/adguardhome-sync: origin
spec:
  serviceAccountName: agh-e2e
  initContainers:
    - name: wait-for-others
      image: bitnami/kubectl:1.24
      command:
        - /bin/bash
        - -c
        - |
          #!/bin/bash
          kubectl get pods -o wide
  containers:
    - name: adguardhome-sync
      image: ghcr.io/bakito/adguardhome-sync:main
      command:
        - /opt/go/adguardhome-sync
        - run
      envFrom:
        - configMapRef:
            name: sync-conf
  restartPolicy: Never
